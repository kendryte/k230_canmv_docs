# K230 SHA256 æ•™ç¨‹

## ä»€ä¹ˆæ˜¯ SHA256ï¼Ÿ

**SHA256ï¼ˆSecure Hash Algorithm 256ï¼‰**
æ˜¯ä¸€ç§å¸¸ç”¨çš„å“ˆå¸Œç®—æ³•ï¼Œè¾“å‡ºé•¿åº¦å›ºå®šä¸º 256 ä½ï¼ˆ32 å­—èŠ‚ï¼‰ï¼Œå¸¸ç”¨äºï¼š

* æ•°æ®å®Œæ•´æ€§æ ¡éªŒï¼ˆå¦‚æ–‡ä»¶ã€é€šä¿¡ï¼‰
* æ•°å­—ç­¾åä¸èº«ä»½è®¤è¯
* åŒºå—é“¾ä¸å¯†ç å­¦ç›¸å…³ç³»ç»Ÿ

## æ¥å£ç®€è¿°

| æ¥å£å                 | åŠŸèƒ½è¯´æ˜             |
| ------------------- | ---------------- |
| `uhashlib.sha256()` | åˆ›å»º SHA256 å¯¹è±¡     |
| `.update(data)`     | å‘å“ˆå¸Œå¯¹è±¡è¾“å…¥æ•°æ®ï¼ˆå¯å¤šæ¬¡è°ƒç”¨ï¼‰ |
| `.digest()`         | è¿”å›è®¡ç®—å‡ºçš„å“ˆå¸Œå€¼ï¼ˆbytesï¼‰ |

## ç¤ºä¾‹ï¼šä½¿ç”¨ SHA256 å“ˆå¸Œè®¡ç®—

ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ K230 çš„ `uhashlib` æ¨¡å—è¿›è¡Œ SHA256 å“ˆå¸Œè¿ç®—ã€‚

### ç¤ºä¾‹ 1ï¼šä¸€æ¬¡æ€§æ›´æ–°æ•°æ®

```python
import uhashlib

# åˆå§‹åŒ– SHA256 å¯¹è±¡
obj = uhashlib.sha256()

# è¾“å…¥æ¶ˆæ¯
msg = b'\x45\x11\x01\x25\x0e\xc6\xf2\x66\x52\x24\x9d\x59\xdc\x97\x4b\x73' \
      b'\x61\xd5\x71\xa8\x10\x1c\xdf\xd3\x6a\xba\x3b\x58\x54\xd3\xae\x08' \
      b'\x6b\x5f\xdd\x45\x97\x72\x1b\x66\xe3\xc0\xdc\x5d\x8c\x60\x6d\x96' \
      b'\x57\xd0\xe3\x23\x28\x3a\x52\x17\xd1\xf5\x3f\x2f\x28\x4f\x57\xb8'

# æ­£ç¡®çš„å‚è€ƒå“ˆå¸Œå€¼ï¼ˆæ¥è‡ªç¡¬ä»¶åŠ é€Ÿå™¨ï¼‰
expected = b'\x1a\xaa\xf9\x28\x5a\xf9\x45\xb8\xa9\x7c\xf1\x4f\x86\x9b\x18\x90' \
           b'\x14\xc3\x84\xf3\xc7\xc2\xb7\xd2\xdf\x8a\x97\x13\xbf\xfe\x0b\xf1'

# å“ˆå¸Œè®¡ç®—
obj.update(msg)
digest = obj.digest()

# éªŒè¯ç»“æœ
print("SHA256 ä¸€æ¬¡ update æµ‹è¯•æˆåŠŸ:", digest == expected)
```

### ç¤ºä¾‹ 2ï¼šå¤šæ¬¡è°ƒç”¨ `update()`

```python
obj = uhashlib.sha256()

# åˆ†ä¸¤æ¬¡è¾“å…¥æ•°æ®
obj.update(b'hello')
obj.update(b'world')

# æ­£ç¡®çš„ SHA256 å€¼
expected = b'\x93\x6a\x18\x5c\xaa\xa2\x66\xbb\x9c\xbe\x98\x1e\x9e\x05\xcb\x78' \
           b'\xcd\x73\x2b\x0b\x32\x80\xeb\x94\x44\x12\xbb\x6f\x8f\x8f\x07\xaf'

digest = obj.digest()
print("SHA256 å¤šæ¬¡ update æµ‹è¯•æˆåŠŸ:", digest == expected)
```

### ç¤ºä¾‹ 3

```python
import uhashlib
import binascii

obj = uhashlib.sha256()
obj.update(b'helloworld')
print(binascii.hexlify(obj.digest()).decode())
```

## åº”ç”¨åœºæ™¯ç¤ºä¾‹

| åœºæ™¯      | è¯´æ˜                    |
| ------- | --------------------- |
| é€šä¿¡å®‰å…¨æ ¡éªŒ  | é€šè¿‡å“ˆå¸ŒéªŒè¯æ¥æ”¶å†…å®¹æ˜¯å¦è¢«ç¯¡æ”¹       |
| å›ºä»¶å®Œæ•´æ€§éªŒè¯ | éªŒè¯ç¨‹åºé•œåƒæ–‡ä»¶æˆ–OTAåŒ…çš„å“ˆå¸Œå€¼     |
| æ•°å­—ç­¾å    | ä¸ºæ•°æ®ç”Ÿæˆæ‘˜è¦å‚ä¸ç­¾åè¿ç®—         |
| åŒºå—é“¾ä¸å¯†ç å­¦ | å¸¸ç”¨äºåŒºå—å“ˆå¸Œè®¡ç®—ã€Merkle æ ‘ç­‰ç»“æ„ |

## å¸¸è§é—®é¢˜è§£ç­”

> **Qï¼šå¯ä»¥å¤šæ¬¡è°ƒç”¨ `update()` å—ï¼Ÿ**

Aï¼šå¯ä»¥ã€‚`uhashlib.sha256()` æ”¯æŒæµå¼æ•°æ®è¾“å…¥ï¼Œé€‚åˆå¤„ç†å¤§æ•°æ®æˆ–åˆ†å—è¯»å–çš„æƒ…å†µã€‚

> **Qï¼šè°ƒç”¨ `.digest()` åè¿˜èƒ½ç»§ç»­è°ƒç”¨ `update()` å—ï¼Ÿ**

Aï¼šä¸å»ºè®®ã€‚`.digest()` ä¼šç»“æŸå½“å‰å“ˆå¸ŒçŠ¶æ€ï¼Œè‹¥éœ€ç»§ç»­ï¼Œè¯·é‡æ–°åˆ›å»º SHA256 å¯¹è±¡ã€‚

## å»¶ä¼¸é˜…è¯»

* ğŸ“˜ [K230 Hashlib API æ‰‹å†Œ](../../api/cipher/K230_CanMV_Hashlibæ¨¡å—APIæ‰‹å†Œ.md)
* ğŸ” [SHA256 æ ‡å‡†å®šä¹‰ (NIST)](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf)
* ğŸ§ª [åœ¨çº¿ SHA256 å“ˆå¸Œå·¥å…·](https://emn178.github.io/online-tools/sha256.html)
